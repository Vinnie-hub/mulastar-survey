<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>MULASTAR | Professional Assessment</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    />
    <style>
      :root {
        --primary-color: #2c3e50;
        --secondary-color: #3498db;
        --accent-color: #2ecc71;
        --danger-color: #e74c3c;
        --warning-color: #f39c12;
        --light-color: #f8f9fa;
        --dark-color: #2c3e50;
        --border-radius: 12px;
        --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        --mobile-padding: 16px;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      html {
        font-size: 16px;
        scroll-behavior: smooth;
      }

      body {
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          Oxygen,
          Ubuntu,
          sans-serif;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        color: #333;
        line-height: 1.5;
        min-height: 100vh;
        padding: var(--mobile-padding);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .professional-container {
        max-width: 100%;
        margin: 0 auto;
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        overflow: hidden;
        min-height: calc(100vh - 2 * var(--mobile-padding));
      }

      /* Header - Mobile Optimized */
      .dashboard-header {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          #1a2530 100%
        );
        color: white;
        padding: 20px var(--mobile-padding);
        position: relative;
      }

      .mobile-header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .branding {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo {
        width: 44px;
        height: 44px;
        background: var(--accent-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        font-weight: 800;
        flex-shrink: 0;
      }

      .branding-text h1 {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 4px;
        line-height: 1.2;
      }

      .branding-text p {
        font-size: 12px;
        opacity: 0.9;
      }

      .mobile-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin-top: 10px;
      }

      .stat-item-mobile {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 12px 8px;
        text-align: center;
      }

      .stat-value-mobile {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 4px;
      }

      .stat-label-mobile {
        font-size: 11px;
        opacity: 0.8;
        text-transform: uppercase;
        letter-spacing: 0.3px;
      }

      /* Timer Section - Mobile Optimized */
      .timer-section {
        background: #f8f9fa;
        padding: 16px var(--mobile-padding);
        border-bottom: 1px solid #eaeaea;
      }

      .timer-display-mobile {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
      }

      .timer-left {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .timer-icon {
        color: var(--danger-color);
        font-size: 18px;
      }

      .timer {
        font-size: 20px;
        font-weight: 700;
        color: var(--danger-color);
        background: white;
        padding: 6px 16px;
        border-radius: 50px;
        border: 2px solid var(--danger-color);
        min-width: 90px;
        text-align: center;
      }

      .earnings-badge {
        background: linear-gradient(90deg, #f39c12, #e67e22);
        color: white;
        padding: 8px 14px;
        border-radius: 50px;
        font-weight: 700;
        font-size: 13px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .progress-container-mobile {
        width: 100%;
      }

      .progress-info-mobile {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 13px;
        font-weight: 600;
      }

      .progress-bar-mobile {
        height: 6px;
        background-color: #e9ecef;
        border-radius: 3px;
        overflow: hidden;
      }

      .progress-fill-mobile {
        height: 100%;
        background: linear-gradient(90deg, var(--accent-color), #27ae60);
        width: 10%;
        border-radius: 3px;
        transition: width 0.5s ease;
      }

      /* Questions Container - Mobile Optimized */
      .questions-container {
        padding: 16px var(--mobile-padding);
        max-height: calc(100vh - 400px);
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }

      /* Mobile Question Navigation */
      .question-nav-mobile {
        display: flex;
        overflow-x: auto;
        padding: 12px 0;
        margin-bottom: 16px;
        gap: 8px;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
      }

      .question-nav-mobile::-webkit-scrollbar {
        display: none;
      }

      .question-nav-item {
        flex-shrink: 0;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        transition: var(--transition);
        background: #e9ecef;
        color: #666;
      }

      .question-nav-item.active {
        background: var(--secondary-color);
        color: white;
        transform: scale(1.1);
      }

      .question-nav-item.answered {
        background: #c8e6c9;
        color: #2e7d32;
      }

      /* Question Cards - Mobile Optimized */
      .question-card-mobile {
        background: white;
        border-radius: var(--border-radius);
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid #eaeaea;
        transition: var(--transition);
      }

      .question-card-mobile.active {
        border-color: var(--secondary-color);
        box-shadow: 0 4px 12px rgba(52, 152, 219, 0.15);
      }

      .question-header-mobile {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid #f0f0f0;
      }

      .question-meta-mobile {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
      }

      .question-number-mobile {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        background: var(--primary-color);
        color: white;
        border-radius: 50%;
        font-weight: 700;
        font-size: 14px;
      }

      .question-category-mobile {
        padding: 5px 12px;
        border-radius: 50px;
        font-size: 11px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.3px;
      }

      .category-mental {
        background: #e3f2fd;
        color: #1565c0;
      }

      .category-math {
        background: #f3e5f5;
        color: #7b1fa2;
      }

      .category-business {
        background: #e8f5e9;
        color: #2e7d32;
      }

      .question-value-mobile {
        background: linear-gradient(90deg, #f39c12, #e67e22);
        color: white;
        padding: 6px 12px;
        border-radius: 50px;
        font-weight: 700;
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .question-text-mobile {
        font-size: 16px;
        font-weight: 600;
        color: var(--dark-color);
        margin-bottom: 20px;
        line-height: 1.4;
      }

      /* Mobile Options - Single Column */
      .options-container-mobile {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 15px;
      }

      .option-card-mobile {
        padding: 16px;
        border: 2px solid #e0e0e0;
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
      }

      .option-card-mobile:active {
        transform: scale(0.98);
      }

      .option-card-mobile:hover {
        border-color: var(--secondary-color);
        background-color: #f8fafc;
      }

      .option-card-mobile.selected {
        border-color: var(--secondary-color);
        background-color: #e3f2fd;
      }

      .option-card-mobile.correct {
        border-color: var(--accent-color);
        background-color: #d4edda;
      }

      .option-card-mobile.incorrect {
        border-color: var(--danger-color);
        background-color: #f8d7da;
      }

      .option-indicator-mobile {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #f0f0f0;
        color: #666;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 12px;
        font-weight: 700;
        font-size: 14px;
        flex-shrink: 0;
      }

      .selected .option-indicator-mobile {
        background: var(--secondary-color);
        color: white;
      }

      .correct .option-indicator-mobile {
        background: var(--accent-color);
        color: white;
      }

      .incorrect .option-indicator-mobile {
        background: var(--danger-color);
        color: white;
      }

      .option-text-mobile {
        font-size: 15px;
        flex-grow: 1;
        line-height: 1.4;
      }

      .feedback-box-mobile {
        margin-top: 12px;
        padding: 12px;
        border-radius: 8px;
        font-size: 14px;
        display: none;
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .feedback-correct {
        background: #d4edda;
        color: #155724;
        border-left: 4px solid var(--accent-color);
      }

      .feedback-incorrect {
        background: #f8d7da;
        color: #721c24;
        border-left: 4px solid var(--danger-color);
      }

      /* Mobile Navigation Buttons */
      .survey-navigation-mobile {
        padding: 16px var(--mobile-padding);
        border-top: 1px solid #eaeaea;
        background: #f8f9fa;
        position: sticky;
        bottom: 0;
        z-index: 100;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
      }

      .nav-buttons-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }

      .nav-button-mobile {
        padding: 14px;
        border: none;
        border-radius: var(--border-radius);
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        min-height: 48px;
      }

      .nav-button-mobile:active {
        transform: scale(0.98);
      }

      .nav-button-mobile:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .button-outline-mobile {
        background: transparent;
        border: 2px solid var(--secondary-color);
        color: var(--secondary-color);
      }

      .button-outline-mobile:active:not(:disabled) {
        background: var(--secondary-color);
        color: white;
      }

      .button-primary-mobile {
        background: var(--secondary-color);
        color: white;
        border: 2px solid var(--secondary-color);
      }

      .button-primary-mobile:active:not(:disabled) {
        background: #2980b9;
        border-color: #2980b9;
      }

      .button-success-mobile {
        background: var(--accent-color);
        color: white;
        border: 2px solid var(--accent-color);
        grid-column: span 2;
      }

      .button-success-mobile:active:not(:disabled) {
        background: #27ae60;
        border-color: #27ae60;
      }

      /* Mobile Results Dashboard */
      .results-dashboard-mobile {
        padding: 20px var(--mobile-padding);
        display: none;
      }

      .dashboard-header-results-mobile {
        text-align: center;
        margin-bottom: 30px;
      }

      .dashboard-header-results-mobile h2 {
        font-size: 24px;
        color: var(--primary-color);
        margin-bottom: 8px;
      }

      .dashboard-header-results-mobile p {
        color: #666;
        font-size: 16px;
      }

      .earnings-card-mobile {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        color: white;
        border-radius: var(--border-radius);
        padding: 30px 20px;
        margin-bottom: 24px;
        text-align: center;
        box-shadow: 0 8px 20px rgba(46, 204, 113, 0.3);
      }

      .earnings-label-mobile {
        font-size: 16px;
        margin-bottom: 12px;
        opacity: 0.9;
      }

      .earnings-amount-mobile {
        font-size: 48px;
        font-weight: 800;
        margin-bottom: 8px;
      }

      .earnings-details-mobile {
        font-size: 14px;
        opacity: 0.9;
      }

      .score-breakdown-mobile {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        margin-bottom: 30px;
      }

      .breakdown-card-mobile {
        background: white;
        border-radius: var(--border-radius);
        padding: 20px 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        text-align: center;
        border-top: 4px solid var(--secondary-color);
      }

      .breakdown-card-mobile.correct {
        border-top-color: var(--accent-color);
      }

      .breakdown-card-mobile.incorrect {
        border-top-color: var(--danger-color);
      }

      .breakdown-card-mobile.earned {
        border-top-color: var(--warning-color);
      }

      .breakdown-icon-mobile {
        font-size: 32px;
        margin-bottom: 12px;
        color: var(--secondary-color);
      }

      .breakdown-card-mobile.correct .breakdown-icon-mobile {
        color: var(--accent-color);
      }

      .breakdown-card-mobile.incorrect .breakdown-icon-mobile {
        color: var(--danger-color);
      }

      .breakdown-card-mobile.earned .breakdown-icon-mobile {
        color: var(--warning-color);
      }

      .breakdown-value-mobile {
        font-size: 28px;
        font-weight: 800;
        margin-bottom: 6px;
      }

      .breakdown-label-mobile {
        font-size: 12px;
        color: #666;
      }

      .welcome-message-mobile {
        background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        border-radius: var(--border-radius);
        padding: 20px;
        margin: 24px 0;
        display: none;
        animation: fadeIn 1s ease;
        border-left: 5px solid var(--secondary-color);
      }

      .welcome-header-mobile {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
      }

      .welcome-icon-mobile {
        font-size: 28px;
        color: var(--secondary-color);
      }

      .welcome-message-mobile h3 {
        font-size: 20px;
        color: var(--primary-color);
      }

      .welcome-message-mobile p {
        font-size: 15px;
        color: #2c3e50;
        line-height: 1.5;
      }

      .action-buttons-mobile {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 30px;
      }

      .button-icon-mobile {
        margin-right: 6px;
      }

      /* Mobile Scrollbar */
      .questions-container::-webkit-scrollbar {
        width: 4px;
      }

      .questions-container::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }

      .questions-container::-webkit-scrollbar-thumb {
        background: #c1c1c1;
        border-radius: 10px;
      }

      /* Tablet and Desktop Responsive */
      @media (min-width: 768px) {
        :root {
          --mobile-padding: 24px;
        }

        body {
          padding: 20px;
        }

        .professional-container {
          max-width: 800px;
          margin: 0 auto;
        }

        .dashboard-header {
          padding: 25px 30px;
        }

        .branding-text h1 {
          font-size: 24px;
        }

        .question-text-mobile {
          font-size: 18px;
        }

        .options-container-mobile {
          grid-template-columns: repeat(2, 1fr);
          display: grid;
        }

        .nav-buttons-container {
          display: flex;
          justify-content: space-between;
        }

        .nav-button-mobile {
          min-width: 150px;
        }

        .button-success-mobile {
          grid-column: auto;
        }
      }

      @media (min-width: 1024px) {
        .professional-container {
          max-width: 1000px;
        }

        .dashboard-header {
          padding: 30px 40px;
        }

        .timer-section {
          padding: 20px 40px;
        }

        .questions-container {
          padding: 30px 40px;
        }

        .survey-navigation-mobile {
          padding: 20px 40px;
        }

        .results-dashboard-mobile {
          padding: 40px;
        }
      }

      /* Small Phone Optimization */
      @media (max-width: 360px) {
        :root {
          --mobile-padding: 12px;
        }

        html {
          font-size: 15px;
        }

        .logo {
          width: 40px;
          height: 40px;
          font-size: 18px;
        }

        .branding-text h1 {
          font-size: 18px;
        }

        .stat-item-mobile {
          padding: 10px 6px;
        }

        .stat-value-mobile {
          font-size: 16px;
        }

        .question-text-mobile {
          font-size: 15px;
        }

        .option-text-mobile {
          font-size: 14px;
        }
      }

      /* Safe area for notched phones */
      @supports (padding: max(0px)) {
        body {
          padding-left: max(var(--mobile-padding), env(safe-area-inset-left));
          padding-right: max(var(--mobile-padding), env(safe-area-inset-right));
          padding-top: max(var(--mobile-padding), env(safe-area-inset-top));
          padding-bottom: max(
            var(--mobile-padding),
            env(safe-area-inset-bottom)
          );
        }
      }
    </style>
  </head>
  <body>
    <div class="professional-container">
      <!-- Mobile Optimized Header -->
      <header class="dashboard-header">
        <div class="mobile-header-top">
          <div class="branding">
            <div class="logo">M</div>
            <div class="branding-text">
              <h1>MULASTAR</h1>
              <p>Professional Assessment</p>
            </div>
          </div>
        </div>

        <div class="mobile-stats">
          <div class="stat-item-mobile">
            <div class="stat-value-mobile" id="totalQuestions">10</div>
            <div class="stat-label-mobile">Questions</div>
          </div>
          <div class="stat-item-mobile">
            <div class="stat-value-mobile">
              KSH <span id="potentialEarnings">100</span>
            </div>
            <div class="stat-label-mobile">Potential</div>
          </div>
          <div class="stat-item-mobile">
            <div class="stat-value-mobile" id="answeredCount">0</div>
            <div class="stat-label-mobile">Answered</div>
          </div>
        </div>
      </header>

      <!-- Mobile Timer Section -->
      <section class="timer-section">
        <div class="timer-display-mobile">
          <div class="timer-left">
            <i class="fas fa-clock timer-icon"></i>
            <div class="timer" id="timer">03:00</div>
          </div>
          <div class="earnings-badge">
            <i class="fas fa-coins"></i>
            KSH 10/Q
          </div>
        </div>

        <div class="progress-container-mobile">
          <div class="progress-info-mobile">
            <span>Q<span id="currentQuestion">1</span>/10</span>
            <span><span id="progressPercent">10%</span></span>
          </div>
          <div class="progress-bar-mobile">
            <div class="progress-fill-mobile" id="progressFill"></div>
          </div>
        </div>
      </section>

      <!-- Mobile Question Navigation -->
      <div class="question-nav-mobile" id="questionNav">
        <!-- Dynamic navigation items will be added here -->
      </div>

      <!-- Mobile Questions Container -->
      <main class="questions-container" id="questionsContainer">
        <!-- Questions will be dynamically inserted here -->
      </main>

      <!-- Mobile Navigation -->
      <section class="survey-navigation-mobile">
        <div class="nav-buttons-container">
          <button class="nav-button-mobile button-outline-mobile" id="prevBtn">
            <i class="fas fa-arrow-left button-icon-mobile"></i>
            <span class="button-text">Previous</span>
          </button>
          <button class="nav-button-mobile button-primary-mobile" id="nextBtn">
            <span class="button-text">Next</span>
            <i class="fas fa-arrow-right button-icon-mobile"></i>
          </button>
          <button
            class="nav-button-mobile button-success-mobile"
            id="submitBtn"
            style="display: none"
          >
            <i class="fas fa-paper-plane button-icon-mobile"></i>
            <span class="button-text">Submit Survey</span>
          </button>
        </div>
      </section>

      <!-- Mobile Results Dashboard -->
      <section class="results-dashboard-mobile" id="resultsDashboard">
        <div class="dashboard-header-results-mobile">
          <h2>Assessment Completed</h2>
          <p>Your results are ready</p>
        </div>

        <div class="earnings-card-mobile">
          <div class="earnings-label-mobile">Total Earnings</div>
          <div class="earnings-amount-mobile" id="earningsAmount">KSH 0</div>
          <div class="earnings-details-mobile">
            <span id="correctCount">0</span> correct answers at KSH 10 each
          </div>
        </div>

        <div class="welcome-message-mobile" id="welcomeMessage">
          <div class="welcome-header-mobile">
            <i class="fas fa-handshake welcome-icon-mobile"></i>
            <h3>Welcome Back!</h3>
          </div>
          <p>
            Great to see you again! Your commitment to professional growth is
            impressive. Keep up the excellent work.
          </p>
        </div>

        <div class="score-breakdown-mobile">
          <div class="breakdown-card-mobile correct">
            <i class="fas fa-check-circle breakdown-icon-mobile"></i>
            <div class="breakdown-value-mobile" id="correctDisplay">0</div>
            <div class="breakdown-label-mobile">Correct</div>
          </div>
          <div class="breakdown-card-mobile incorrect">
            <i class="fas fa-times-circle breakdown-icon-mobile"></i>
            <div class="breakdown-value-mobile" id="incorrectDisplay">0</div>
            <div class="breakdown-label-mobile">Incorrect</div>
          </div>
          <div class="breakdown-card-mobile earned">
            <i class="fas fa-chart-line breakdown-icon-mobile"></i>
            <div class="breakdown-value-mobile" id="percentageDisplay">0%</div>
            <div class="breakdown-label-mobile">Success Rate</div>
          </div>
        </div>

        <div class="action-buttons-mobile">
          <button
            class="nav-button-mobile button-outline-mobile"
            id="reviewBtn"
          >
            <i class="fas fa-eye button-icon-mobile"></i>
            <span class="button-text">Review Answers</span>
          </button>
          <button
            class="nav-button-mobile button-primary-mobile"
            id="restartBtn"
          >
            <i class="fas fa-redo button-icon-mobile"></i>
            <span class="button-text">Retake Assessment</span>
          </button>
        </div>
      </section>
    </div>

    <script>
      // Mobile-optimized survey configuration
      const CONFIG = {
        QUESTION_VALUE: 10,
        TOTAL_QUESTIONS: 10,
        TIME_LIMIT: 180,
        STORAGE_KEY: "mulastar_mobile_survey",
      };

      // Survey questions
      const surveyQuestions = [
        {
          id: 1,
          category: "mental",
          question:
            "What is the most effective approach to handling failure professionally?",
          options: [
            { letter: "A", text: "Give up and move on", correct: false },
            { letter: "B", text: "Learn and try again", correct: true },
            { letter: "C", text: "Blame others", correct: false },
            { letter: "D", text: "Ignore it", correct: false },
          ],
          feedback: {
            correct: "Correct. Learning from failure builds resilience.",
            incorrect:
              "The best approach is to learn from failure and try again.",
          },
        },
        {
          id: 2,
          category: "mental",
          question: "A positive mindset helps you to…",
          options: [
            { letter: "A", text: "Stay stagnant", correct: false },
            { letter: "B", text: "Grow and improve", correct: true },
            { letter: "C", text: "Avoid challenges", correct: false },
            { letter: "D", text: "Stop learning", correct: false },
          ],
          feedback: {
            correct:
              "Right! A positive mindset encourages continuous improvement.",
            incorrect:
              "A positive mindset actually helps you grow and improve.",
          },
        },
        {
          id: 3,
          category: "mental",
          question: "What is gratitude?",
          options: [
            { letter: "A", text: "Complaining", correct: false },
            { letter: "B", text: "Being thankful", correct: true },
            { letter: "C", text: "Comparing to others", correct: false },
            { letter: "D", text: "Feeling angry", correct: false },
          ],
          feedback: {
            correct: "Exactly! Gratitude is appreciating what you have.",
            incorrect: "Gratitude means being thankful for what you have.",
          },
        },
        {
          id: 4,
          category: "mental",
          question: "Which is a good habit for mental strength?",
          options: [
            { letter: "A", text: "Negative self-talk", correct: false },
            { letter: "B", text: "Setting small goals", correct: true },
            { letter: "C", text: "Avoiding challenges", correct: false },
            { letter: "D", text: "Overthinking", correct: false },
          ],
          feedback: {
            correct: "Correct. Small goals build confidence over time.",
            incorrect:
              "Setting small goals builds mental strength incrementally.",
          },
        },
        {
          id: 5,
          category: "math",
          question: "What is 25 + 15?",
          options: [
            { letter: "A", text: "30", correct: false },
            { letter: "B", text: "35", correct: false },
            { letter: "C", text: "40", correct: true },
            { letter: "D", text: "45", correct: false },
          ],
          feedback: {
            correct: "Correct: 25 + 15 = 40",
            incorrect: "The correct answer is 40.",
          },
        },
        {
          id: 6,
          category: "math",
          question: "What is 12 × 5?",
          options: [
            { letter: "A", text: "50", correct: false },
            { letter: "B", text: "55", correct: false },
            { letter: "C", text: "60", correct: true },
            { letter: "D", text: "65", correct: false },
          ],
          feedback: {
            correct: "Correct: 12 × 5 = 60",
            incorrect: "The correct answer is 60.",
          },
        },
        {
          id: 7,
          category: "math",
          question: "3 items costing KSH 20 each total:",
          options: [
            { letter: "A", text: "KSH 40", correct: false },
            { letter: "B", text: "KSH 50", correct: false },
            { letter: "C", text: "KSH 60", correct: true },
            { letter: "D", text: "KSH 70", correct: false },
          ],
          feedback: {
            correct: "Correct: 3 × 20 = KSH 60",
            incorrect: "Total is KSH 60 (3 × 20).",
          },
        },
        {
          id: 8,
          category: "business",
          question: "What is profit?",
          options: [
            { letter: "A", text: "Money lost", correct: false },
            { letter: "B", text: "Money after expenses", correct: true },
            { letter: "C", text: "Total debt", correct: false },
            { letter: "D", text: "Free money", correct: false },
          ],
          feedback: {
            correct: "Correct. Profit is money earned after expenses.",
            incorrect: "Profit is money earned after all expenses.",
          },
        },
        {
          id: 9,
          category: "business",
          question: "Who is a customer?",
          options: [
            { letter: "A", text: "Buys your product", correct: true },
            { letter: "B", text: "Steals", correct: false },
            { letter: "C", text: "Refuses to pay", correct: false },
            { letter: "D", text: "Sleeps", correct: false },
          ],
          feedback: {
            correct: "Right! A customer purchases your product/service.",
            incorrect: "A customer is someone who buys your product/service.",
          },
        },
        {
          id: 10,
          category: "business",
          question: "A successful business needs…",
          options: [
            { letter: "A", text: "No planning", correct: false },
            { letter: "B", text: "Good products", correct: true },
            { letter: "C", text: "Laziness", correct: false },
            { letter: "D", text: "No customers", correct: false },
          ],
          feedback: {
            correct: "Exactly! Good products and consistency are key.",
            incorrect: "Success requires good products and consistency.",
          },
        },
      ];

      // Application State
      const state = {
        currentQuestionIndex: 0,
        userAnswers: new Array(CONFIG.TOTAL_QUESTIONS).fill(null),
        timeRemaining: CONFIG.TIME_LIMIT,
        timerInterval: null,
        surveyCompleted: false,
        lastCompletionTimestamp:
          localStorage.getItem(`${CONFIG.STORAGE_KEY}_last_completion`) || null,
      };

      // DOM Elements
      const elements = {
        questionsContainer: document.getElementById("questionsContainer"),
        questionNav: document.getElementById("questionNav"),
        timer: document.getElementById("timer"),
        currentQuestion: document.getElementById("currentQuestion"),
        progressFill: document.getElementById("progressFill"),
        progressPercent: document.getElementById("progressPercent"),
        answeredCount: document.getElementById("answeredCount"),
        prevBtn: document.getElementById("prevBtn"),
        nextBtn: document.getElementById("nextBtn"),
        submitBtn: document.getElementById("submitBtn"),
        resultsDashboard: document.getElementById("resultsDashboard"),
        earningsAmount: document.getElementById("earningsAmount"),
        correctCount: document.getElementById("correctCount"),
        correctDisplay: document.getElementById("correctDisplay"),
        incorrectDisplay: document.getElementById("incorrectDisplay"),
        percentageDisplay: document.getElementById("percentageDisplay"),
        welcomeMessage: document.getElementById("welcomeMessage"),
        reviewBtn: document.getElementById("reviewBtn"),
        restartBtn: document.getElementById("restartBtn"),
      };

      // Initialize Mobile Application
      function initMobileApp() {
        renderQuestionNavigation();
        renderCurrentQuestion();
        updateMobileStats();
        startMobileTimer();
        checkMobileWelcomeBack();
      }

      // Render question navigation dots
      function renderQuestionNavigation() {
        let navHTML = "";

        for (let i = 0; i < CONFIG.TOTAL_QUESTIONS; i++) {
          const isActive = i === state.currentQuestionIndex;
          const isAnswered = state.userAnswers[i] !== null;

          let navClass = "question-nav-item";
          if (isActive) navClass += " active";
          if (isAnswered) navClass += " answered";

          navHTML += `<div class="${navClass}" data-index="${i}">${i + 1}</div>`;
        }

        elements.questionNav.innerHTML = navHTML;

        // Add click event listeners
        document.querySelectorAll(".question-nav-item").forEach((item) => {
          item.addEventListener("click", function () {
            const index = parseInt(this.getAttribute("data-index"));
            state.currentQuestionIndex = index;
            renderCurrentQuestion();
            updateQuestionNavigation();
          });
        });
      }

      // Update question navigation highlights
      function updateQuestionNavigation() {
        document
          .querySelectorAll(".question-nav-item")
          .forEach((item, index) => {
            const isActive = index === state.currentQuestionIndex;
            const isAnswered = state.userAnswers[index] !== null;

            item.classList.toggle("active", isActive);
            item.classList.toggle("answered", isAnswered);
          });
      }

      // Render current question
      function renderCurrentQuestion() {
        const question = surveyQuestions[state.currentQuestionIndex];
        const userAnswer = state.userAnswers[state.currentQuestionIndex];

        // Get category styling
        let categoryClass = "";
        let categoryText = "";
        switch (question.category) {
          case "mental":
            categoryClass = "category-mental";
            categoryText = "Mindset";
            break;
          case "math":
            categoryClass = "category-math";
            categoryText = "Math";
            break;
          case "business":
            categoryClass = "category-business";
            categoryText = "Business";
            break;
        }

        // Generate options HTML
        let optionsHTML = "";
        question.options.forEach((option) => {
          const isSelected = userAnswer === option.letter;
          let optionClass = "option-card-mobile";

          if (isSelected) optionClass += " selected";
          if (state.surveyCompleted) {
            if (option.correct) optionClass += " correct";
            else if (isSelected && !option.correct) optionClass += " incorrect";
          }

          optionsHTML += `
                    <div class="${optionClass}" data-letter="${option.letter}">
                        <div class="option-indicator-mobile">${option.letter}</div>
                        <div class="option-text-mobile">${option.text}</div>
                    </div>
                `;
        });

        // Generate feedback if completed
        let feedbackHTML = "";
        if (state.surveyCompleted && userAnswer !== null) {
          const selectedOption = question.options.find(
            (opt) => opt.letter === userAnswer,
          );
          const isCorrect = selectedOption ? selectedOption.correct : false;
          const feedbackClass = isCorrect
            ? "feedback-correct"
            : "feedback-incorrect";
          const feedbackText = isCorrect
            ? question.feedback.correct
            : question.feedback.incorrect;

          feedbackHTML = `<div class="feedback-box-mobile ${feedbackClass}">${feedbackText}</div>`;
        }

        const questionHTML = `
                <div class="question-card-mobile active">
                    <div class="question-header-mobile">
                        <div class="question-meta-mobile">
                            <div class="question-number-mobile">${state.currentQuestionIndex + 1}</div>
                            <div class="question-category-mobile ${categoryClass}">${categoryText}</div>
                        </div>
                        <div class="question-value-mobile">
                            <i class="fas fa-coins"></i>
                            KSH ${CONFIG.QUESTION_VALUE}
                        </div>
                    </div>
                    <div class="question-text-mobile">${question.question}</div>
                    <div class="options-container-mobile">
                        ${optionsHTML}
                    </div>
                    ${feedbackHTML}
                </div>
            `;

        elements.questionsContainer.innerHTML = questionHTML;

        // Add event listeners to options
        document.querySelectorAll(".option-card-mobile").forEach((option) => {
          option.addEventListener("click", () => {
            if (state.surveyCompleted) return;

            const selectedLetter = option.getAttribute("data-letter");

            // Update answer
            state.userAnswers[state.currentQuestionIndex] = selectedLetter;

            // Update UI
            updateOptionSelection(selectedLetter);
            updateMobileStats();
            updateMobileNavigation();
            updateQuestionNavigation();
          });
        });

        // Update progress
        updateMobileProgress();

        // Scroll to top of question
        elements.questionsContainer.scrollTop = 0;
      }

      // Update option selection
      function updateOptionSelection(selectedLetter) {
        const options = document.querySelectorAll(".option-card-mobile");

        options.forEach((opt) => {
          opt.classList.remove("selected");
          const letter = opt.getAttribute("data-letter");
          if (letter === selectedLetter) {
            opt.classList.add("selected");
          }
        });
      }

      // Update mobile statistics
      function updateMobileStats() {
        const answered = state.userAnswers.filter(
          (answer) => answer !== null,
        ).length;
        elements.answeredCount.textContent = answered;
      }

      // Update mobile progress
      function updateMobileProgress() {
        const progress =
          ((state.currentQuestionIndex + 1) / CONFIG.TOTAL_QUESTIONS) * 100;
        elements.progressFill.style.width = `${progress}%`;
        elements.progressPercent.textContent = `${Math.round(progress)}%`;
        elements.currentQuestion.textContent = state.currentQuestionIndex + 1;
      }

      // Update mobile navigation buttons
      function updateMobileNavigation() {
        // Previous button
        elements.prevBtn.disabled = state.currentQuestionIndex === 0;

        // Next/Submit buttons
        if (state.currentQuestionIndex === CONFIG.TOTAL_QUESTIONS - 1) {
          elements.nextBtn.style.display = "none";
          elements.submitBtn.style.display = "flex";

          // Enable submit only if all questions answered
          const allAnswered = state.userAnswers.every(
            (answer) => answer !== null,
          );
          elements.submitBtn.disabled = !allAnswered;
        } else {
          elements.nextBtn.style.display = "flex";
          elements.submitBtn.style.display = "none";
        }

        // Enable next only if current question answered
        elements.nextBtn.disabled =
          state.userAnswers[state.currentQuestionIndex] === null;

        // Update button texts for mobile
        const prevText = elements.prevBtn.querySelector(".button-text");
        const nextText = elements.nextBtn.querySelector(".button-text");

        if (state.currentQuestionIndex === 0) {
          prevText.textContent = "Back";
        } else {
          prevText.textContent = "Previous";
        }

        if (state.currentQuestionIndex === CONFIG.TOTAL_QUESTIONS - 1) {
          nextText.textContent = "Last";
        } else {
          nextText.textContent = "Next";
        }
      }

      // Mobile timer functions
      function startMobileTimer() {
        updateMobileTimerDisplay();
        state.timerInterval = setInterval(() => {
          state.timeRemaining--;
          updateMobileTimerDisplay();

          if (state.timeRemaining <= 0) {
            clearInterval(state.timerInterval);
            if (!state.surveyCompleted) {
              autoSubmitMobileSurvey();
            }
          }
        }, 1000);
      }

      function updateMobileTimerDisplay() {
        const minutes = Math.floor(state.timeRemaining / 60);
        const seconds = state.timeRemaining % 60;
        elements.timer.textContent = `${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

        // Visual warning for low time
        if (state.timeRemaining <= 30) {
          elements.timer.style.color = "var(--danger-color)";
          elements.timer.style.borderColor = "var(--danger-color)";
          elements.timer.style.animation =
            state.timeRemaining % 2 === 0 ? "none" : "pulse 1s infinite";
        }
      }

      // Calculate mobile results
      function calculateMobileResults() {
        let correct = 0;
        let incorrect = 0;

        state.userAnswers.forEach((answer, index) => {
          if (answer !== null) {
            const question = surveyQuestions[index];
            const selectedOption = question.options.find(
              (opt) => opt.letter === answer,
            );
            if (selectedOption && selectedOption.correct) {
              correct++;
            } else {
              incorrect++;
            }
          } else {
            incorrect++;
          }
        });

        const earnings = correct * CONFIG.QUESTION_VALUE;
        const percentage = Math.round((correct / CONFIG.TOTAL_QUESTIONS) * 100);

        return { correct, incorrect, earnings, percentage };
      }

      // Show mobile results
      function showMobileResults() {
        state.surveyCompleted = true;
        clearInterval(state.timerInterval);

        // Calculate results
        const results = calculateMobileResults();

        // Update results display
        elements.earningsAmount.textContent = `KSH ${results.earnings}`;
        elements.correctCount.textContent = results.correct;
        elements.correctDisplay.textContent = results.correct;
        elements.incorrectDisplay.textContent = results.incorrect;
        elements.percentageDisplay.textContent = `${results.percentage}%`;

        // Store completion time
        localStorage.setItem(
          `${CONFIG.STORAGE_KEY}_last_completion`,
          Date.now().toString(),
        );

        // Show dashboard
        document.querySelector(".questions-container").style.display = "none";
        document.querySelector(".survey-navigation-mobile").style.display =
          "none";
        document.querySelector(".question-nav-mobile").style.display = "none";
        elements.resultsDashboard.style.display = "block";

        // Show welcome message if applicable
        checkMobileWelcomeBack();
      }

      // Auto-submit mobile survey
      function autoSubmitMobileSurvey() {
        // Fill unanswered questions
        state.userAnswers = state.userAnswers.map((answer) =>
          answer === null ? "" : answer,
        );
        showMobileResults();
      }

      // Check and show mobile welcome back
      function checkMobileWelcomeBack() {
        if (!state.lastCompletionTimestamp) return;

        const oneHourMs = 60 * 60 * 1000;
        const timeSinceLast =
          Date.now() - parseInt(state.lastCompletionTimestamp);

        if (timeSinceLast >= oneHourMs) {
          setTimeout(() => {
            elements.welcomeMessage.style.display = "block";
          }, 500);
        }
      }

      // Event Listeners for Mobile
      elements.prevBtn.addEventListener("click", () => {
        if (state.currentQuestionIndex > 0) {
          state.currentQuestionIndex--;
          renderCurrentQuestion();
          updateMobileNavigation();
          updateQuestionNavigation();
        }
      });

      elements.nextBtn.addEventListener("click", () => {
        if (state.currentQuestionIndex < CONFIG.TOTAL_QUESTIONS - 1) {
          state.currentQuestionIndex++;
          renderCurrentQuestion();
          updateMobileNavigation();
          updateQuestionNavigation();
        }
      });

      elements.submitBtn.addEventListener("click", () => {
        showMobileResults();
      });

      elements.reviewBtn.addEventListener("click", () => {
        // Go back to first question for review
        state.currentQuestionIndex = 0;
        elements.resultsDashboard.style.display = "none";
        document.querySelector(".questions-container").style.display = "block";
        document.querySelector(".survey-navigation-mobile").style.display =
          "flex";
        document.querySelector(".question-nav-mobile").style.display = "flex";
        renderCurrentQuestion();
        updateMobileNavigation();
        updateQuestionNavigation();
      });

      elements.restartBtn.addEventListener("click", () => {
        // Reset state
        state.currentQuestionIndex = 0;
        state.userAnswers = new Array(CONFIG.TOTAL_QUESTIONS).fill(null);
        state.timeRemaining = CONFIG.TIME_LIMIT;
        state.surveyCompleted = false;

        // Reset UI
        elements.resultsDashboard.style.display = "none";
        document.querySelector(".questions-container").style.display = "block";
        document.querySelector(".survey-navigation-mobile").style.display =
          "flex";
        document.querySelector(".question-nav-mobile").style.display = "flex";
        elements.welcomeMessage.style.display = "none";

        // Reset timer
        elements.timer.style.color = "var(--danger-color)";
        elements.timer.style.borderColor = "var(--danger-color)";
        elements.timer.style.animation = "none";

        // Reinitialize
        initMobileApp();
      });

      // Handle mobile back button
      window.addEventListener("popstate", function (event) {
        if (state.currentQuestionIndex > 0) {
          state.currentQuestionIndex--;
          renderCurrentQuestion();
          updateMobileNavigation();
          updateQuestionNavigation();
          history.pushState(null, null, window.location.pathname);
        }
      });

      // Prevent zoom on double-tap
      let lastTouchEnd = 0;
      document.addEventListener(
        "touchend",
        function (event) {
          const now = new Date().getTime();
          if (now - lastTouchEnd <= 300) {
            event.preventDefault();
          }
          lastTouchEnd = now;
        },
        false,
      );

      // Initialize on load
      document.addEventListener("DOMContentLoaded", initMobileApp);

      // Handle orientation change
      window.addEventListener("orientationchange", function () {
        setTimeout(updateMobileProgress, 100);
      });
    </script>
  </body>
</html>
